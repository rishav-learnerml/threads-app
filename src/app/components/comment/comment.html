<article
  class="bg-[#101010] rounded-xl border border-gray-800 shadow-sm p-4 sm:p-6 text-white"
>
  <div class="flex items-start gap-4">
    <!-- Avatar -->
    <img
      [src]="`https://api.dicebear.com/7.x/fun-emoji/svg?seed=${comment().user.name}`"
      class="h-10 w-10 rounded-full object-cover border border-gray-700"
      alt="User Avatar"
    />

    <div class="flex-1">
      <!-- Username -->
      <h3 class="text-base font-semibold leading-tight text-white">
        {{ comment().user.name }}
      </h3>

      <!-- Comment Text -->
      <p class="mt-2 text-sm text-gray-300 whitespace-pre-line">
        {{ comment().text }}
      </p>

      <!-- Actions -->
      <div class="mt-4 flex items-center gap-6 text-sm text-gray-400">
        <button
          (click)="toggleReply()"
          class="hover:text-white transition-colors"
        >
          ðŸ’¬ Reply
        </button>

        <button
          class="flex items-center gap-1 hover:text-red-400 transition-colors"
          (click)="toggleLike()"
          [class.text-red-400]="comment().liked"
        >
          <span class="pb-1 text-[15px]">{{ comment().likes }}</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-5 h-5"
            viewBox="0 0 24 24"
          >
            <path
              [attr.fill]="comment().liked ? '#ef4444' : 'none'"
              [attr.stroke]="comment().liked ? '#ef4444' : '#ffffff'"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M21.752 7.376c0-2.162-1.752-3.914-3.914-3.914-1.378 0-2.593.704-3.318 1.782-.725-1.078-1.94-1.782-3.318-1.782-2.162 0-3.914 1.752-3.914 3.914 0 5.677 7.232 10.327 7.232 10.327s7.232-4.65 7.232-10.327z"
            />
          </svg>
        </button>

        <button
          class="transition-transform duration-200"
          [class.rotate-180]="expanded()"
          (click)="toggleExpand()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-5 h-5 text-gray-400 hover:text-white transition"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m19.5 8.25-7.5 7.5-7.5-7.5"
            />
          </svg>
        </button>
      </div>

      <!-- Reply Box -->
      @if (isReplying()) {
      <section class="mt-4 pl-6 border-l border-gray-700">
        <app-comment-form
          placeholder="Write your reply"
          buttonText="Send"
          (formSubmitted)="createComment($event)"
        ></app-comment-form>
      </section>
      }

      <!-- Nested Comments -->
      @if (expanded()) {
      <section class="mt-4 pl-6 border-l border-gray-700 space-y-4">
        @for (ncomment of nestedComments(); track ncomment._id) {
        <app-comment [comment]="ncomment"></app-comment>
        }
      </section>
      }
    </div>
  </div>
</article>
